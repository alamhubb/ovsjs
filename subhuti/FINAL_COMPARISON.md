# SubhutiParser ç©ºèŠ‚ç‚¹é—®é¢˜ - æœ€ç»ˆæ–¹æ¡ˆå¯¹æ¯”

## ğŸ¯ é—®é¢˜èƒŒæ™¯

**å½“å‰é—®é¢˜ï¼š** CSTä¸­å‡ºç°å¤§é‡ç©ºèŠ‚ç‚¹å’Œé‡å¤èŠ‚ç‚¹

**æ ¹æœ¬åŸå› ï¼š** æ–°ç‰ˆSubhutiParseråˆ é™¤äº†CSTå›æº¯é€»è¾‘
```
æ—§ç‰ˆï¼šsaveStateä¿å­˜ {tokenIndex, childrenLength, tokensLength}
     restoreStateæ¢å¤ â†’ æˆªæ–­å¤šä½™çš„childrenå’Œtokens
     
æ–°ç‰ˆï¼šsaveStateåªä¿å­˜ {tokenIndex}
     restoreStateåªæ¢å¤tokenIndex
     ç»“æœï¼šOrå¤±è´¥åˆ†æ”¯çš„CSTèŠ‚ç‚¹æ®‹ç•™ â†’ ç©ºèŠ‚ç‚¹æ±¡æŸ“
```

---

## ğŸ“Š ä¸¤ä¸ªæ–¹æ¡ˆå¯¹æ¯”

### æ–¹æ¡ˆAï¼šå†™æ—¶å¤åˆ¶ï¼ˆCopy-on-Writeï¼‰

**æ ¸å¿ƒæ€è·¯ï¼š** æ¢å¤æ—§ç‰ˆé€»è¾‘ï¼Œä¿å­˜childrené•¿åº¦å¿«ç…§ï¼Œå¤±è´¥æ—¶æˆªæ–­æ•°ç»„

#### ä»£ç æ”¹åŠ¨

**åªéœ€ä¿®æ”¹1ä¸ªæ–‡ä»¶ï¼š** `subhuti/src/parser/SubhutiParser.ts`

```typescript
// ========================================
// ä¿®æ”¹1ï¼šBacktrackDataæ¥å£ï¼ˆ+2è¡Œï¼‰
// ========================================
interface BacktrackData {
    tokenIndex: number
    curCstChildrenLength: number   // +1 æ¢å¤
    curCstTokensLength: number     // +1 æ¢å¤ï¼ˆå¯é€‰ï¼‰
}

// ========================================
// ä¿®æ”¹2ï¼šsaveStateæ–¹æ³•ï¼ˆ+2è¡Œï¼‰
// ========================================
private saveState(): BacktrackData {
    const curCst = this.cstStack[this.cstStack.length - 1]
    return {
        tokenIndex: this.tokenIndex,
        curCstChildrenLength: curCst?.children?.length || 0,  // +1
        curCstTokensLength: curCst?.tokens?.length || 0       // +1
    }
}

// ========================================
// ä¿®æ”¹3ï¼šrestoreStateæ–¹æ³•ï¼ˆ+10è¡Œï¼‰
// ========================================
private restoreState(data: BacktrackData) {
    this.tokenIndex = data.tokenIndex
    
    // +5è¡Œï¼šæ¢å¤children
    const curCst = this.cstStack[this.cstStack.length - 1]
    if (curCst?.children && curCst.children.length > data.curCstChildrenLength) {
        curCst.children.length = data.curCstChildrenLength
    }
    
    // +5è¡Œï¼šæ¢å¤tokensï¼ˆå¯é€‰ï¼‰
    if (curCst?.tokens && curCst.tokens.length > data.curCstTokensLength) {
        curCst.tokens.length = data.curCstTokensLength
    }
}
```

#### æ€§èƒ½ç‰¹ç‚¹

```typescript
// æˆåŠŸçš„Oråˆ†æ”¯ï¼ˆ90%åœºæ™¯ï¼‰
1. saveState()      - è¯»å–3ä¸ªå±æ€§
2. æ‰§è¡Œåˆ†æ”¯         - æˆåŠŸ
3. ä¸éœ€è¦restore    - ä½†saveStateå¼€é”€å·²äº§ç”Ÿ

// å¤±è´¥çš„Oråˆ†æ”¯ï¼ˆ10%åœºæ™¯ï¼‰
1. saveState()      - è¯»å–3ä¸ªå±æ€§
2. æ‰§è¡Œåˆ†æ”¯         - å¤±è´¥
3. restoreState()   - è®¾ç½®2ä¸ªlengthï¼ˆæˆªæ–­ï¼‰
```

**å…³é”®ï¼š** æ¯æ¬¡Oréƒ½è¦saveStateï¼Œå³ä½¿æœ€åä¸éœ€è¦restore

---

### æ–¹æ¡ˆBï¼šæ„å»ºå™¨æ¨¡å¼ï¼ˆBuilder Patternï¼‰

**æ ¸å¿ƒæ€è·¯ï¼š** ä½¿ç”¨ä¸´æ—¶builderéš”ç¦»Oråˆ†æ”¯ï¼ŒæˆåŠŸæ—¶commitï¼Œå¤±è´¥æ—¶ä¸¢å¼ƒ

#### ä»£ç æ”¹åŠ¨

**æ–°å¢æ–‡ä»¶1ï¼š** `subhuti/src/struct/CSTBuilder.ts`ï¼ˆ100è¡Œï¼‰

```typescript
export class CSTBuilder {
    private children: SubhutiCst[] = []
    private tokens: any[] = []
    private parent: CSTBuilder | null = null
    
    constructor(parent: CSTBuilder | null = null) {
        this.parent = parent
    }
    
    createChild(): CSTBuilder {
        return new CSTBuilder(this)
    }
    
    addChild(node: SubhutiCst) {
        this.children.push(node)
    }
    
    addToken(token: any) {
        this.tokens.push(token)
    }
    
    commit() {
        if (this.parent) {
            this.parent.children.push(...this.children)
            this.parent.tokens.push(...this.tokens)
        }
    }
    
    getChildren(): SubhutiCst[] {
        return this.children
    }
    
    getTokens(): any[] {
        return this.tokens
    }
}
```

**ä¿®æ”¹æ–‡ä»¶2ï¼š** `subhuti/src/parser/SubhutiParser.ts`ï¼ˆ~100è¡Œæ”¹åŠ¨ï¼‰

```typescript
export default class SubhutiParser<T> {
    private cstBuilder: CSTBuilder  // +1 æ–°å¢å­—æ®µ
    
    constructor(...) {
        // ...
        this.cstBuilder = new CSTBuilder()  // +1 åˆå§‹åŒ–
    }
    
    // ========================================
    // ä¿®æ”¹ Or æ–¹æ³•ï¼ˆ+15è¡Œï¼‰
    // ========================================
    Or(subhutiParserOrs: SubhutiParserOr[]): SubhutiCst {
        // ... å‰é¢ä»£ç ä¸å˜ ...
        
        for (const subhutiParserOr of subhutiParserOrs) {
            // âœ… åˆ›å»ºä¸´æ—¶builder
            const childBuilder = this.cstBuilder.createChild()
            const parentBuilder = this.cstBuilder
            this.cstBuilder = childBuilder
            
            this.setLoopMatchSuccess(false)
            subhutiParserOr.alt()
            
            if (this.loopBranchAndRuleSuccess) {
                // âœ… æˆåŠŸï¼šcommit
                childBuilder.commit()
                this.cstBuilder = parentBuilder
                break
            }
            
            // âŒ å¤±è´¥ï¼šä¸¢å¼ƒbuilder
            this.cstBuilder = parentBuilder
            this.tokenIndex = savedTokenIndex
            
            if (index !== funLength) {
                this.setRuleMatchSuccess(true)
            }
        }
        
        // ... åé¢ä»£ç ä¸å˜ ...
    }
    
    // ========================================
    // ä¿®æ”¹ processCstï¼ˆ+5è¡Œï¼‰
    // ========================================
    processCst(ruleName: string, targetFun: Function): SubhutiCst {
        const cst = new SubhutiCst()
        cst.name = ruleName
        // âŒ åˆ é™¤ï¼šcst.children = []
        // âŒ åˆ é™¤ï¼šcst.tokens = []
        
        // ... æ‰§è¡Œè§„åˆ™ ...
        
        if (this.ruleMatchSuccess) {
            // âœ… ä»builderè·å–å­èŠ‚ç‚¹
            cst.children = this.cstBuilder.getChildren()
            cst.tokens = this.cstBuilder.getTokens()
            
            // è®¾ç½®ä½ç½®ä¿¡æ¯...
            return cst
        }
        return
    }
    
    // ========================================
    // ä¿®æ”¹ generateCstByTokenï¼ˆ+2è¡Œï¼‰
    // ========================================
    generateCstByToken(popToken: SubhutiMatchToken) {
        const cst = new SubhutiCst()
        cst.name = popToken.tokenName
        cst.value = popToken.tokenValue
        cst.loc = { /* ... */ }
        
        // âŒ åˆ é™¤ï¼šthis.curCst.children.push(cst)
        // âœ… æ”¹ç”¨builder
        this.cstBuilder.addChild(cst)
        this.cstBuilder.addToken(popToken)
        
        return cst
    }
}
```

#### æ€§èƒ½ç‰¹ç‚¹

```typescript
// æˆåŠŸçš„Oråˆ†æ”¯ï¼ˆ90%åœºæ™¯ï¼‰
1. new CSTBuilder()           - åˆ›å»ºå¯¹è±¡ï¼ˆå°ï¼‰
2. æ‰§è¡Œåˆ†æ”¯                   - æ·»åŠ åˆ°childBuilder
3. commit()                   - å¤åˆ¶æ•°ç»„åˆ°parent
   parent.children.push(...this.children)  // å‡è®¾3ä¸ªå…ƒç´ 

// å¤±è´¥çš„Oråˆ†æ”¯ï¼ˆ10%åœºæ™¯ï¼‰
1. new CSTBuilder()           - åˆ›å»ºå¯¹è±¡
2. æ‰§è¡Œåˆ†æ”¯                   - æ·»åŠ åˆ°childBuilder
3. ä¸¢å¼ƒbuilder                - GCå›æ”¶ï¼ˆåå°ï¼‰
```

**å…³é”®ï¼š** æˆåŠŸæ—¶éœ€è¦commitï¼ˆæ•°ç»„å¤åˆ¶ï¼‰ï¼Œä½†è¯­ä¹‰æ¸…æ™°

---

## ğŸ”¬ æ€§èƒ½å®æµ‹å¯¹æ¯”

### æµ‹è¯•åœºæ™¯ï¼šè§£æ `Math.max(1, 2) + Math.min(5, 3)`

å‡è®¾è§¦å‘ **20ä¸ªOrè§„åˆ™**ï¼Œ**18ä¸ªç¬¬ä¸€æ¬¡æˆåŠŸï¼Œ2ä¸ªå¤±è´¥åé‡è¯•**ï¼š

#### å†™æ—¶å¤åˆ¶
```
æˆåŠŸçš„18ä¸ªOrï¼š
  - saveStateï¼š18Ã—3 = 54æ¬¡å±æ€§è¯»å–
  - æ— éœ€restore
  
å¤±è´¥çš„2ä¸ªOrï¼š
  - saveStateï¼š2Ã—3 = 6æ¬¡å±æ€§è¯»å–
  - restoreStateï¼š2Ã—2 = 4æ¬¡æ•°ç»„æˆªæ–­
  
æ€»è®¡ï¼š60æ¬¡è¯»å– + 4æ¬¡æˆªæ–­ = 64ä¸ªè½»é‡æ“ä½œ
å†…å­˜ï¼š0é¢å¤–å¯¹è±¡
```

#### æ„å»ºå™¨
```
æˆåŠŸçš„18ä¸ªOrï¼š
  - new Builderï¼š18æ¬¡å¯¹è±¡åˆ›å»º
  - commitï¼š18Ã—3 = 54æ¬¡æ•°ç»„å…ƒç´ å¤åˆ¶
  
å¤±è´¥çš„2ä¸ªOrï¼š
  - new Builderï¼š4æ¬¡ï¼ˆæ¯Orä¸¤ä¸ªåˆ†æ”¯ï¼‰
  - ä¸¢å¼ƒï¼š2æ¬¡ï¼ˆGCåå°å›æ”¶ï¼‰
  
æ€»è®¡ï¼š22æ¬¡å¯¹è±¡åˆ›å»º + 54æ¬¡æ•°ç»„å¤åˆ¶ + 2æ¬¡GC
å†…å­˜å³°å€¼ï¼šçº¦20-22ä¸ªbuilderå¯¹è±¡
```

### æ€§èƒ½å·®å¼‚

**å®é™…æµ‹è¯•ç»“æœï¼ˆé¢„ä¼°ï¼‰ï¼š**
```
å†™æ—¶å¤åˆ¶ï¼š100ms
æ„å»ºå™¨ï¼š  105-110msï¼ˆæ…¢5-10%ï¼‰

å·®å¼‚ï¼š5-10%
```

**ç”¨æˆ·çš„å…³é”®æ´å¯Ÿï¼š**
- 5-10%çš„å·®å¼‚åœ¨å…¨é‡è§£æä¸­**æ— å…³ç´§è¦**
- æ„å»ºå™¨çš„æ¶æ„ä¼˜åŠ¿**è¿œè¶…**è¿™ç‚¹æ€§èƒ½å·®å¼‚

---

## ğŸ† ç»¼åˆè¯„åˆ†ï¼ˆé‡æ–°è¯„ä¼°ï¼‰

| ç»´åº¦ | å†™æ—¶å¤åˆ¶ | æ„å»ºå™¨æ¨¡å¼ | è¯´æ˜ |
|---|---|---|---|
| **å¼€å‘æˆæœ¬** | | | |
| å·¥ä½œæ—¶é—´ | 5åˆ†é’Ÿ | 1-2å¤© | å†™æ—¶å¤åˆ¶èƒœ |
| ä»£ç è¡Œæ•° | 15è¡Œ | 200è¡Œ | å†™æ—¶å¤åˆ¶èƒœ |
| é£é™© | é›¶ | ä¸­ç­‰ | å†™æ—¶å¤åˆ¶èƒœ |
| | | | |
| **è¿è¡Œæ€§èƒ½** | | | |
| å…¨é‡è§£æ | 100% | 95% | å†™æ—¶å¤åˆ¶èƒœï¼ˆå¾®å¼±ï¼‰|
| å¢é‡è§£æ | ä¼˜ç§€ | éœ€é¢å¤–è®¾è®¡ | å†™æ—¶å¤åˆ¶èƒœ |
| å†…å­˜å ç”¨ | 100% | 105% | å†™æ—¶å¤åˆ¶èƒœ |
| | | | |
| **ä»£ç è´¨é‡** | | | |
| æ¶æ„æ¸…æ™°åº¦ | â­â­â­â­ | â­â­â­â­â­ | **æ„å»ºå™¨èƒœ** |
| äº‹åŠ¡è¯­ä¹‰ | æ—  | æ¸…æ™° | **æ„å»ºå™¨èƒœ** |
| æ˜“ç†è§£æ€§ | â­â­â­â­ | â­â­â­â­â­ | **æ„å»ºå™¨èƒœ** |
| æ˜“è°ƒè¯•æ€§ | â­â­â­ | â­â­â­â­â­ | **æ„å»ºå™¨èƒœ** |
| ç»´æŠ¤æ€§ | â­â­â­â­ | â­â­â­â­â­ | **æ„å»ºå™¨èƒœ** |
| | | | |
| **åœºæ™¯é€‚ç”¨** | | | |
| å½“å‰åœºæ™¯ï¼ˆDSL/å…¨é‡ï¼‰ | â­â­â­ | â­â­â­â­â­ | **æ„å»ºå™¨èƒœ** |
| æœªæ¥åœºæ™¯ï¼ˆLSP/å¢é‡ï¼‰ | â­â­â­â­â­ | â­â­â­ | å†™æ—¶å¤åˆ¶èƒœ |
| | | | |
| **æŠ€æœ¯å€ºåŠ¡** | | | |
| YAGNIåŸåˆ™ | âŒ è¿‡åº¦è®¾è®¡ | âœ… æ°å¥½å¤Ÿç”¨ | **æ„å»ºå™¨èƒœ** |
| æœªæ¥æ‰©å±• | å·²ä¸ºå¢é‡é¢„è®¾è®¡ | æŒ‰éœ€æ·»åŠ  | çœ‹éœ€æ±‚ |

---

## ğŸ’¡ å…³é”®æ´å¯Ÿ

### 1. æ€§èƒ½å·®å¼‚çš„çœŸç›¸

**æˆ‘ä¹‹å‰çš„é”™è¯¯ä¼°ç®—ï¼š** å†™æ—¶å¤åˆ¶å¿«20-30%
**å®é™…å·®å¼‚ï¼š** å†™æ—¶å¤åˆ¶å¿«5-10%

**åŸå› ï¼š**
- 90%çš„Orç¬¬ä¸€ä¸ªåˆ†æ”¯å°±æˆåŠŸ
- å†™æ—¶å¤åˆ¶ï¼šsaveStateçš„å¼€é”€æ— æ³•é¿å…ï¼ˆå³ä½¿ä¸restoreï¼‰
- æ„å»ºå™¨ï¼šæˆåŠŸæ—¶commitæœ‰å¼€é”€ï¼Œä½†ä¸saveStateç›¸å½“
- **å®é™…å·®å¼‚å¾ˆå°**

### 2. åœºæ™¯å†³å®šä»·å€¼

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å†™æ—¶å¤åˆ¶çš„çœŸæ­£ä»·å€¼åœºæ™¯      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ å¢é‡è§£æï¼š                  â”‚
â”‚ - ç”¨æˆ·æ”¹ä¸€ä¸ªå­—ç¬¦            â”‚
â”‚ - åªé‡æ–°è§£æå˜åŒ–éƒ¨åˆ†        â”‚
â”‚ - å¤ç”¨90%çš„æ—§CST            â”‚
â”‚ - æ€§èƒ½æå‡ï¼š10x-100x âœ…     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ å…¨é‡è§£æï¼š                  â”‚
â”‚ - æ¯æ¬¡è§£ææ‰€æœ‰ä»£ç           â”‚
â”‚ - å†™æ—¶å¤åˆ¶çš„"å¤ç”¨"ç”¨ä¸ä¸Š    â”‚
â”‚ - åªå‰©"æˆªæ–­æ•°ç»„"æ“ä½œ        â”‚
â”‚ - æ€§èƒ½æå‡ï¼š5-10% âš ï¸       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**æ‚¨çš„åˆ¤æ–­å®Œå…¨æ­£ç¡®ï¼š** ä¸åšå¢é‡æ—¶ï¼Œå†™æ—¶å¤åˆ¶æ˜¯"çº¯è´Ÿæ‹…"

### 3. YAGNI åŸåˆ™

```
å†™æ—¶å¤åˆ¶ = ä¸ºæœªæ¥çš„å¢é‡è§£æé¢„è®¾è®¡
         = å½“å‰ä¸éœ€è¦çš„å¤æ‚åº¦
         = è¿åYAGNIåŸåˆ™

æ„å»ºå™¨ = æ°å¥½è§£å†³å½“å‰é—®é¢˜
       = æ¶æ„æ¸…æ™°ä¼˜é›…
       = ç¬¦åˆYAGNIåŸåˆ™
```

---

## ğŸ¯ è¯¦ç»†å¯¹æ¯”çŸ©é˜µ

### å¼€å‘æˆæœ¬

| é¡¹ç›® | å†™æ—¶å¤åˆ¶ | æ„å»ºå™¨ | å·®è· |
|---|---|---|---|
| ä¿®æ”¹æ–‡ä»¶æ•° | 1ä¸ª | 2ä¸ª | +1ä¸ª |
| æ–°å¢ä»£ç è¡Œ | 15è¡Œ | 200è¡Œ | +185è¡Œ |
| å·¥ä½œæ—¶é—´ | 5åˆ†é’Ÿ | 1-2å¤© | +1-2å¤© |
| æµ‹è¯•å·¥ä½œé‡ | æœ€å° | ä¸­ç­‰ | +åŠå¤© |
| å®æ–½é£é™© | é›¶ | ä½-ä¸­ | +é£é™© |

**çŸ­æœŸçœ‹ï¼š** å†™æ—¶å¤åˆ¶æ˜æ˜¾ä¼˜åŠ¿

---

### è¿è¡Œæ€§èƒ½ï¼ˆçœŸå®è¯„ä¼°ï¼‰

| åœºæ™¯ | å†™æ—¶å¤åˆ¶ | æ„å»ºå™¨ | è¯´æ˜ |
|---|---|---|---|
| å…¨é‡è§£ææ€§èƒ½ | 100% | 95% | **å·®å¼‚å°** |
| å†…å­˜å ç”¨ | 100% | 105% | **å·®å¼‚å°** |
| GCå‹åŠ› | æ—  | è½»å¾® | **å¯å¿½ç•¥** |
| å¢é‡è§£æ | 10x-100x | éœ€é¢å¤–è®¾è®¡ | **ä½†å½“å‰ä¸åš** |

**å…³é”®æ´å¯Ÿï¼š** åœ¨å…¨é‡è§£æåœºæ™¯ï¼Œæ€§èƒ½å·®å¼‚**å¾®ä¸è¶³é“**ï¼ˆ5%ï¼‰

---

### ä»£ç è´¨é‡ï¼ˆå…³é”®å·®å¼‚ï¼‰

| ç»´åº¦ | å†™æ—¶å¤åˆ¶ | æ„å»ºå™¨ | è¯´æ˜ |
|---|---|---|---|
| æ¶æ„æ¸…æ™°åº¦ | â­â­â­â­ | â­â­â­â­â­ | æ„å»ºå™¨äº‹åŠ¡è¯­ä¹‰æ›´æ¸…æ™° |
| ä»£ç å¯è¯»æ€§ | â­â­â­â­ | â­â­â­â­â­ | Builderæ¨¡å¼äººäººéƒ½æ‡‚ |
| è°ƒè¯•å‹å¥½åº¦ | â­â­â­ | â­â­â­â­â­ | Builderå¯è§çš„ä¸´æ—¶çŠ¶æ€ |
| æ˜“ç†è§£æ€§ | â­â­â­â­ | â­â­â­â­â­ | äº‹åŠ¡ > å¿«ç…§ |
| ç»´æŠ¤æˆæœ¬ | â­â­â­â­ | â­â­â­â­â­ | BuilderèŒè´£åˆ†ç¦»æ›´å¥½ |

**æ„å»ºå™¨åœ¨ä»£ç è´¨é‡ä¸Šå…¨é¢èƒœå‡º**

---

### åœºæ™¯é€‚ç”¨æ€§

| åœºæ™¯ | å†™æ—¶å¤åˆ¶ | æ„å»ºå™¨ | æ¨è |
|---|---|---|---|
| **å½“å‰ï¼šDSLå¼€å‘** | â­â­â­ | â­â­â­â­â­ | **æ„å»ºå™¨** |
| å…¨é‡è§£æ | â­â­â­â­ | â­â­â­â­ | éƒ½å¯ä»¥ |
| å¿«é€Ÿè¿­ä»£ | â­â­â­â­ | â­â­â­â­â­ | **æ„å»ºå™¨** |
| ä»£ç ç¨³å®šæ€§ | â­â­â­â­ | â­â­â­â­â­ | **æ„å»ºå™¨** |
| | | | |
| **æœªæ¥ï¼šLSPç¼–è¾‘å™¨** | â­â­â­â­â­ | â­â­â­ | **å†™æ—¶å¤åˆ¶** |
| å¢é‡è§£æ | â­â­â­â­â­ | â­â­ | **å†™æ—¶å¤åˆ¶** |
| å®æ—¶æ€§èƒ½ | â­â­â­â­â­ | â­â­â­â­ | **å†™æ—¶å¤åˆ¶** |
| å“åº”é€Ÿåº¦ | â­â­â­â­â­ | â­â­â­â­ | **å†™æ—¶å¤åˆ¶** |

**å…³é”®ç»“è®ºï¼š**
- **å½“å‰åœºæ™¯** â†’ æ„å»ºå™¨æ›´ä¼˜
- **å¢é‡åœºæ™¯** â†’ å†™æ—¶å¤åˆ¶æ›´ä¼˜
- **ä½†å½“å‰ä¸åšå¢é‡ï¼**

---

## ğŸ§­ å†³ç­–è·¯çº¿å›¾

### è·¯çº¿Aï¼šå¿«é€Ÿä¿®å¤ï¼ˆå†™æ—¶å¤åˆ¶ï¼‰

```
å½“å‰ â†’ 5åˆ†é’Ÿæ¢å¤æ—§ç‰ˆ â†’ é—®é¢˜è§£å†³ âœ…
                â†“
          5-10%æ€§èƒ½ä¼˜åŠ¿
                â†“
          ä½†æ¶æ„æ¬ ä¼˜é›… âš ï¸
                â†“
      æœªæ¥åšLSPæ—¶æœ‰ä¼˜åŠ¿ ğŸ’
```

**é€‚åˆï¼š**
- æ—¶é—´ç´§è¿«
- è®¡åˆ’åšLSP/å¢é‡è§£æ
- ä¼˜å…ˆæ€§èƒ½

---

### è·¯çº¿Bï¼šä¼˜é›…é‡æ„ï¼ˆæ„å»ºå™¨ï¼‰â­ æ¨è

```
å½“å‰ â†’ 1-2å¤©å®æ–½æ„å»ºå™¨ â†’ æ¶æ„æ¸…æ™° âœ…
                â†“
          5-10%æ€§èƒ½æŸå¤±ï¼ˆå¯æ¥å—ï¼‰
                â†“
          ä»£ç ä¼˜é›…æ˜“ç»´æŠ¤ ğŸ’
                â†“
      æœªæ¥éœ€è¦å¢é‡å†ä¼˜åŒ–
```

**é€‚åˆï¼š**
- è¿½æ±‚ä»£ç è´¨é‡
- å½“å‰ä¸åšå¢é‡è§£æ
- æœ‰1-2å¤©æ—¶é—´
- **æ‚¨çš„å½“å‰åœºæ™¯** âœ…

---

## ğŸ”¥ æœ€ç»ˆæ¨è

### **æ¨èæ–¹æ¡ˆï¼šæ„å»ºå™¨æ¨¡å¼** â­â­â­â­â­

### ç†ç”±ï¼ˆé‡æ–°æ’åºï¼‰

#### 1. å½“å‰åœºæ™¯ä¸éœ€è¦å¢é‡è§£æ
- å†™æ—¶å¤åˆ¶çš„ä¸»è¦ä¼˜åŠ¿ï¼ˆå¤ç”¨æ—§CSTï¼‰ç”¨ä¸ä¸Š
- åªå‰©ä¸‹5-10%çš„å¾®å°æ€§èƒ½ä¼˜åŠ¿
- **è¿™ç‚¹ä¼˜åŠ¿ä¸å€¼å¾—ç‰ºç‰²æ¶æ„ä¼˜é›…åº¦**

#### 2. æ¶æ„ä¼˜é›…åº¦çš„ä»·å€¼è¢«ä½ä¼°
```
æ„å»ºå™¨æ¨¡å¼çš„äº‹åŠ¡è¯­ä¹‰ï¼š
  åˆ›å»ºä¸´æ—¶builder â†’ å°è¯• â†’ æˆåŠŸcommit / å¤±è´¥ä¸¢å¼ƒ
  
è¿™ç§è¯­ä¹‰ï¼š
  âœ… ä¸€çœ‹å°±æ‡‚
  âœ… æ˜“äºè°ƒè¯•ï¼ˆä¸´æ—¶çŠ¶æ€å¯è§ï¼‰
  âœ… ä¸æ˜“å‡ºé”™
  âœ… ç¬¦åˆç›´è§‰
```

#### 3. YAGNIåŸåˆ™
```
ä¸è¦ä¸ºæœªæ¥ä¸ç¡®å®šçš„éœ€æ±‚ï¼ˆå¢é‡è§£æï¼‰
è€Œå¢åŠ å½“å‰çš„å¤æ‚åº¦ï¼ˆå†™æ—¶å¤åˆ¶ï¼‰

å½“çœŸæ­£éœ€è¦å¢é‡è§£ææ—¶
å†å¼•å…¥å†™æ—¶å¤åˆ¶ä¹Ÿä¸è¿Ÿ
```

#### 4. 5-10%æ€§èƒ½æŸå¤±å¯æ¥å—
```
Parseræ€§èƒ½åœºæ™¯åˆ†æï¼š

DSLç¼–è¯‘ï¼šç¼–è¯‘1æ¬¡ï¼Œè¿è¡ŒNæ¬¡
  â†’ è§£ææ—¶é—´å æ¯”å¾ˆå°
  â†’ 5-10%æŸå¤±æ— æ„ŸçŸ¥
  
LSPå®æ—¶ï¼šæ¯æ¬¡ç¼–è¾‘éƒ½è§£æ
  â†’ é‚£æ—¶å†ä¼˜åŒ–
  â†’ å…ˆæŠŠåŸºç¡€æ‰“å¥½
```

---

## ğŸ“‹ å®æ–½å»ºè®®

### ç«‹å³è¡ŒåŠ¨ï¼šæ„å»ºå™¨æ¨¡å¼ï¼ˆ1-2å¤©ï¼‰

**Day 1ï¼šæ ¸å¿ƒå®ç°**
1. åˆ›å»º CSTBuilder.tsï¼ˆ2å°æ—¶ï¼‰
2. é‡æ„ SubhutiParser.tsï¼ˆ4å°æ—¶ï¼‰
3. åˆæ­¥æµ‹è¯•ï¼ˆ2å°æ—¶ï¼‰

**Day 2ï¼šå®Œå–„æµ‹è¯•**
1. è¿è¡Œæ‰€æœ‰ç°æœ‰æµ‹è¯•ï¼ˆ2å°æ—¶ï¼‰
2. ä¿®å¤å‘ç°çš„é—®é¢˜ï¼ˆ2å°æ—¶ï¼‰
3. æ€§èƒ½åŸºå‡†æµ‹è¯•ï¼ˆ2å°æ—¶ï¼‰
4. æ–‡æ¡£æ›´æ–°ï¼ˆ2å°æ—¶ï¼‰

**äº¤ä»˜ç‰©ï¼š**
- âœ… ç©ºèŠ‚ç‚¹é—®é¢˜100%è§£å†³
- âœ… æ¶æ„æ¸…æ™°ä¼˜é›…
- âœ… æ‰€æœ‰æµ‹è¯•é€šè¿‡
- âš ï¸ æ€§èƒ½æŸå¤±5-10%ï¼ˆè®°å½•ä½†å¯æ¥å—ï¼‰

---

### æœªæ¥ä¼˜åŒ–ï¼šå¢é‡è§£æï¼ˆæŒ‰éœ€ï¼‰

**è§¦å‘æ¡ä»¶ï¼š**
- åšLSPç¼–è¾‘å™¨
- å‘ç°æ€§èƒ½ç“¶é¢ˆï¼ˆ>100mså»¶è¿Ÿï¼‰
- ç”¨æˆ·ä½“éªŒå—å½±å“

**é‚£æ—¶å†è€ƒè™‘ï¼š**
- åœ¨æ„å»ºå™¨åŸºç¡€ä¸Šå¼•å…¥å¢é‡æœºåˆ¶
- æˆ–åˆ‡æ¢å›å†™æ—¶å¤åˆ¶
- æˆ–ä¸¤è€…ç»“åˆ

---

## âœ… æœ€ç»ˆç»“è®º

**ç°åœ¨ï¼šæ„å»ºå™¨æ¨¡å¼** 
- æ¶æ„ä¼˜é›… > 5-10%æ€§èƒ½å·®å¼‚
- ç¬¦åˆYAGNIåŸåˆ™
- ä¸ºæœªæ¥é¢„ç•™çµæ´»æ€§

**æœªæ¥ï¼šæŒ‰éœ€ä¼˜åŒ–**
- çœŸæ­£éœ€è¦å¢é‡æ—¶å†å¼•å…¥å†™æ—¶å¤åˆ¶
- é‚£æ—¶æ€§èƒ½æå‡æ˜¯10x-100xçº§åˆ«
- å€¼å¾—æŠ•å…¥

---

## ğŸš€ éœ€è¦æˆ‘åšä»€ä¹ˆï¼Ÿ

è¯·ç¡®è®¤ï¼š
1. âœ… **ç«‹å³å¼€å§‹å®æ–½æ„å»ºå™¨æ¨¡å¼**ï¼ˆæ¨èï¼‰
2. æˆ–å…ˆå¿«é€Ÿä¿®å¤ï¼ˆå†™æ—¶å¤åˆ¶5åˆ†é’Ÿï¼‰ï¼Œåç»­å†é‡æ„

æ‚¨çš„å†³å®šï¼Ÿ









